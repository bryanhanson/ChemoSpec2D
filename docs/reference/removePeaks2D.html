<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Remove Peaks in a Spectra2D Object — removePeaks2D • ChemoSpec2D</title>

<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script>
<!-- Bootstrap -->
<link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/cerulean/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css" integrity="sha256-eZrrJcwDc/3uDhsdt61sL2oOBY362qM3lon1gyExkL0=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script>

<!-- sticky kit -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/sticky-kit/1.1.3/sticky-kit.min.js" integrity="sha256-c4Rlo1ZozqTPE2RLuvbusY3+SU1pQaJC0TjuhygMipw=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>



<meta property="og:title" content="Remove Peaks in a Spectra2D Object — removePeaks2D" />

<meta property="og:description" content="This function sets peaks at specified frequencies in a Spectra2D
object to NA. This effectively removes these peaks from calculations of
contours which can speed things up and clarifies the visual presentation of data.
This function is useful for removing regions with large
interfering peaks (e.g. the water peak in 1H NMR), or regions that are primarily
noise.  This function leaves the frequency axes intact.  Note that the
parafac function does not allow NA
in the input data matrices.  See removeFreq for a way to shrink
the data set without introducing NAs." />
<meta name="twitter:card" content="summary" />



<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->


  </head>

  <body>
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">ChemoSpec2D</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.2.19</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../articles/ChemoSpec2D.pdf">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
      
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/bryanhanson/ChemoSpec2D">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      
      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Remove Peaks in a Spectra2D Object</h1>
    <small class="dont-index">Source: <a href='https://github.com/bryanhanson/ChemoSpec2D/blob/master/R/removePeaks2D.R'><code>R/removePeaks2D.R</code></a></small>
    <div class="hidden name"><code>removePeaks2D.Rd</code></div>
    </div>

    <div class="ref-description">
    
    <p>This function sets peaks at specified frequencies in a <code><a href='Spectra2D.html'>Spectra2D</a></code>
object to <code>NA</code>. This effectively removes these peaks from calculations of
contours which can speed things up and clarifies the visual presentation of data.
This function is useful for removing regions with large
interfering peaks (e.g. the water peak in 1H NMR), or regions that are primarily
noise.  This function leaves the frequency axes intact.  Note that the
<code><a href='https://www.rdocumentation.org/packages/multiway/topics/parafac'>parafac</a></code> function does not allow <code>NA</code>
in the input data matrices.  See <code><a href='removeFreq.html'>removeFreq</a></code> for a way to shrink
the data set without introducing <code>NA</code>s.</p>
    
    </div>

    <pre class="usage"><span class='fu'>removePeaks2D</span>(<span class='no'>spectra</span>, <span class='kw'>remF2</span> <span class='kw'>=</span> <span class='kw'>NULL</span>, <span class='kw'>remF1</span> <span class='kw'>=</span> <span class='kw'>NULL</span>)</pre>
    
    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>spectra</th>
      <td><p>An object of S3 class <code><a href='Spectra2D.html'>Spectra2D</a></code> from which to
remove selected peaks.</p></td>
    </tr>
    <tr>
      <th>remF2</th>
      <td><p>A formula giving the range of frequencies to be set to <code>NA</code>.  May include
"low" or "high" representing the extremes of the spectra.    Values outside the range of
F2 are tolerated without notice and are handled <code>min</code> or <code>max</code>.See the examples.</p></td>
    </tr>
    <tr>
      <th>remF1</th>
      <td><p>As for <code>remF2</code>.</p></td>
    </tr>
    </table>
    
    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>An object of S3 class <code><a href='Spectra2D.html'>Spectra2D</a></code>.</p>
    
    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <div class='dont-index'><p><code><a href='https://www.rdocumentation.org/packages/ChemoSpecUtils/topics/removeFreq'>removeFreq</a></code>.</p></div>
    

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='co'># Note we will set contours a bit low to better</span>
<span class='co'># show what is going on.</span>

<span class='fu'><a href='https://www.rdocumentation.org/packages/utils/topics/data'>data</a></span>(<span class='no'>MUD1</span>)
<span class='no'>mylvls</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/seq'>seq</a></span>(-<span class='fl'>0.3</span>, <span class='fl'>0.3</span>, <span class='fl'>0.1</span>)
<span class='no'>mylvls</span>[<span class='fl'>4</span>] <span class='kw'>&lt;-</span> <span class='fl'>0.05</span>

<span class='fu'><a href='plotSpectra2D.html'>plotSpectra2D</a></span>(<span class='no'>MUD1</span>, <span class='kw'>which</span> <span class='kw'>=</span> <span class='fl'>7</span>, <span class='kw'>lvls</span> <span class='kw'>=</span> <span class='no'>mylvls</span>,
  <span class='kw'>main</span> <span class='kw'>=</span> <span class='st'>"MUD1 Sample 7: Complete Data Set"</span>)</div><div class='img'><img src='removePeaks2D-1.png' alt='' width='700' height='433' /></div><div class='input'>
<span class='no'>MUD1a</span> <span class='kw'>&lt;-</span> <span class='fu'>removePeaks2D</span>(<span class='no'>MUD1</span>, <span class='kw'>remF2</span> <span class='kw'>=</span> <span class='fl'>2.5</span> ~ <span class='fl'>4</span>)
<span class='fu'><a href='sumSpectra.html'>sumSpectra</a></span>(<span class='no'>MUD1a</span>)</div><div class='output co'>#&gt; 
#&gt;  MUD1: HSQC-like data for ChemoSpec2D demo &amp; testing 
#&gt; 
#&gt; 	There are 10 spectra in this set.
#&gt; 
#&gt; 	The F2 dimension runs from 0 to 10 ppm
#&gt; 	and there are 51 data points.
#&gt; 
#&gt; 	The F1 dimension runs from 10 to 30 ppm
#&gt; 	and there are 41 slices.
#&gt; 
#&gt; 	NAs were found in the data matrices.  To see where, use plotSpectra2D.
#&gt; 
#&gt; 	The spectra are divided into 2 groups: 
#&gt; 
#&gt;    group no. color
#&gt; 1 GroupA   5   red
#&gt; 2 GroupB   5  blue
#&gt; 
#&gt; 
#&gt; *** Note: this is an S3 object
#&gt; of class 'Spectra2D'</div><div class='input'><span class='fu'><a href='plotSpectra2D.html'>plotSpectra2D</a></span>(<span class='no'>MUD1a</span>, <span class='kw'>which</span> <span class='kw'>=</span> <span class='fl'>7</span>, <span class='kw'>lvls</span> <span class='kw'>=</span> <span class='no'>mylvls</span>,
  <span class='kw'>main</span> <span class='kw'>=</span> <span class='st'>"MUD1 Sample 7\nRemoved Peaks: F2 2.5 ~ 4"</span>)</div><div class='img'><img src='removePeaks2D-2.png' alt='' width='700' height='433' /></div><div class='input'>
<span class='no'>MUD1b</span> <span class='kw'>&lt;-</span> <span class='fu'>removePeaks2D</span>(<span class='no'>MUD1</span>, <span class='kw'>remF2</span> <span class='kw'>=</span> <span class='no'>low</span> ~ <span class='fl'>5</span>)
<span class='fu'><a href='sumSpectra.html'>sumSpectra</a></span>(<span class='no'>MUD1b</span>)</div><div class='output co'>#&gt; 
#&gt;  MUD1: HSQC-like data for ChemoSpec2D demo &amp; testing 
#&gt; 
#&gt; 	There are 10 spectra in this set.
#&gt; 
#&gt; 	The F2 dimension runs from 0 to 10 ppm
#&gt; 	and there are 51 data points.
#&gt; 
#&gt; 	The F1 dimension runs from 10 to 30 ppm
#&gt; 	and there are 41 slices.
#&gt; 
#&gt; 	NAs were found in the data matrices.  To see where, use plotSpectra2D.
#&gt; 
#&gt; 	The spectra are divided into 2 groups: 
#&gt; 
#&gt;    group no. color
#&gt; 1 GroupA   5   red
#&gt; 2 GroupB   5  blue
#&gt; 
#&gt; 
#&gt; *** Note: this is an S3 object
#&gt; of class 'Spectra2D'</div><div class='input'><span class='fu'><a href='plotSpectra2D.html'>plotSpectra2D</a></span>(<span class='no'>MUD1b</span>, <span class='kw'>which</span> <span class='kw'>=</span> <span class='fl'>7</span>, <span class='kw'>lvls</span> <span class='kw'>=</span> <span class='no'>mylvls</span>,
  <span class='kw'>main</span> <span class='kw'>=</span> <span class='st'>"MUD1 Sample 7\nRemoved Peaks: F2 low ~ 5"</span>)</div><div class='img'><img src='removePeaks2D-3.png' alt='' width='700' height='433' /></div><div class='input'>
<span class='no'>MUD1c</span> <span class='kw'>&lt;-</span> <span class='fu'>removePeaks2D</span>(<span class='no'>MUD1</span>, <span class='kw'>remF1</span> <span class='kw'>=</span> <span class='no'>high</span> ~ <span class='fl'>23</span>)
<span class='fu'><a href='sumSpectra.html'>sumSpectra</a></span>(<span class='no'>MUD1c</span>)</div><div class='output co'>#&gt; 
#&gt;  MUD1: HSQC-like data for ChemoSpec2D demo &amp; testing 
#&gt; 
#&gt; 	There are 10 spectra in this set.
#&gt; 
#&gt; 	The F2 dimension runs from 0 to 10 ppm
#&gt; 	and there are 51 data points.
#&gt; 
#&gt; 	The F1 dimension runs from 10 to 30 ppm
#&gt; 	and there are 41 slices.
#&gt; 
#&gt; 	NAs were found in the data matrices.  To see where, use plotSpectra2D.
#&gt; 
#&gt; 	The spectra are divided into 2 groups: 
#&gt; 
#&gt;    group no. color
#&gt; 1 GroupA   5   red
#&gt; 2 GroupB   5  blue
#&gt; 
#&gt; 
#&gt; *** Note: this is an S3 object
#&gt; of class 'Spectra2D'</div><div class='input'><span class='fu'><a href='plotSpectra2D.html'>plotSpectra2D</a></span>(<span class='no'>MUD1c</span>, <span class='kw'>which</span> <span class='kw'>=</span> <span class='fl'>7</span>, <span class='kw'>lvls</span> <span class='kw'>=</span> <span class='no'>mylvls</span>,
  <span class='kw'>main</span> <span class='kw'>=</span> <span class='st'>"MUD1 Sample 7\nRemoved Peaks: F1 high ~ 23"</span>)</div><div class='img'><img src='removePeaks2D-4.png' alt='' width='700' height='433' /></div><div class='input'>
<span class='no'>MUD1d</span> <span class='kw'>&lt;-</span> <span class='fu'>removePeaks2D</span>(<span class='no'>MUD1</span>, <span class='kw'>remF2</span> <span class='kw'>=</span> <span class='fl'>2.5</span> ~ <span class='fl'>4</span>, <span class='kw'>remF1</span> <span class='kw'>=</span> <span class='fl'>17</span> ~ <span class='fl'>20</span>)
<span class='fu'><a href='sumSpectra.html'>sumSpectra</a></span>(<span class='no'>MUD1d</span>)</div><div class='output co'>#&gt; 
#&gt;  MUD1: HSQC-like data for ChemoSpec2D demo &amp; testing 
#&gt; 
#&gt; 	There are 10 spectra in this set.
#&gt; 
#&gt; 	The F2 dimension runs from 0 to 10 ppm
#&gt; 	and there are 51 data points.
#&gt; 
#&gt; 	The F1 dimension runs from 10 to 30 ppm
#&gt; 	and there are 41 slices.
#&gt; 
#&gt; 	NAs were found in the data matrices.  To see where, use plotSpectra2D.
#&gt; 
#&gt; 	The spectra are divided into 2 groups: 
#&gt; 
#&gt;    group no. color
#&gt; 1 GroupA   5   red
#&gt; 2 GroupB   5  blue
#&gt; 
#&gt; 
#&gt; *** Note: this is an S3 object
#&gt; of class 'Spectra2D'</div><div class='input'><span class='fu'><a href='plotSpectra2D.html'>plotSpectra2D</a></span>(<span class='no'>MUD1d</span>, <span class='kw'>which</span> <span class='kw'>=</span> <span class='fl'>7</span>, <span class='kw'>lvls</span> <span class='kw'>=</span> <span class='no'>mylvls</span>,
  <span class='kw'>main</span> <span class='kw'>=</span> <span class='st'>"MUD1 Sample 7\nRemoved Peaks: F2 2.5 ~ 4 &amp; F1 17 ~ 20"</span>)</div><div class='img'><img src='removePeaks2D-5.png' alt='' width='700' height='433' /></div><div class='input'>
</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
    <h2>Contents</h2>
    <ul class="nav nav-pills nav-stacked">
      <li><a href="#arguments">Arguments</a></li>
      
      <li><a href="#value">Value</a></li>

      <li><a href="#see-also">See also</a></li>
      
      <li><a href="#examples">Examples</a></li>
    </ul>

    <h2>Author</h2>
    <p>Bryan A. Hanson, DePauw University.</p>
  </div>
</div>

      <footer>
      <div class="copyright">
  <p>Developed by Bryan A. Hanson.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.3.0.</p>
</div>
      </footer>
   </div>

  

  </body>
</html>

