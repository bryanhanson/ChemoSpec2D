<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>PARAFAC Analysis of a Spectra2D Object — pfacSpectra2D • ChemoSpec2D</title>

<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script>
<!-- Bootstrap -->
<link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/cerulean/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css" integrity="sha256-eZrrJcwDc/3uDhsdt61sL2oOBY362qM3lon1gyExkL0=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script>

<!-- sticky kit -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/sticky-kit/1.1.3/sticky-kit.min.js" integrity="sha256-c4Rlo1ZozqTPE2RLuvbusY3+SU1pQaJC0TjuhygMipw=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>



<meta property="og:title" content="PARAFAC Analysis of a Spectra2D Object — pfacSpectra2D" />

<meta property="og:description" content="Carry out PARAFAC analysis of a Spectra2D object.
Function parafac from multiway is used.
For large data sets, computational time may be long enough that
it might desirable to run in batch mode and possibly use parallel processing." />
<meta name="twitter:card" content="summary" />



<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->


  </head>

  <body>
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">ChemoSpec2D</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.3.166</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../articles/ChemoSpec2D.pdf">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
      
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/bryanhanson/ChemoSpec2D">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      
      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>PARAFAC Analysis of a Spectra2D Object</h1>
    <small class="dont-index">Source: <a href='https://github.com/bryanhanson/ChemoSpec2D/blob/master/R/pfacSpectra2D.R'><code>R/pfacSpectra2D.R</code></a></small>
    <div class="hidden name"><code>pfacSpectra2D.Rd</code></div>
    </div>

    <div class="ref-description">
    
    <p>Carry out PARAFAC analysis of a <code><a href='Spectra2D.html'>Spectra2D</a></code> object.
Function <code><a href='https://www.rdocumentation.org/packages/multiway/topics/parafac'>parafac</a></code> from <span class="pkg">multiway</span> is used.
For large data sets, computational time may be long enough that
it might desirable to run in batch mode and possibly use parallel processing.</p>
    
    </div>

    <pre class="usage"><span class='fu'>pfacSpectra2D</span>(<span class='no'>spectra</span>, <span class='kw'>parallel</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>, <span class='kw'>setup</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>, <span class='kw'>nfac</span> <span class='kw'>=</span> <span class='fl'>2</span>,
  <span class='no'>...</span>)</pre>
    
    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>spectra</th>
      <td><p>An object of S3 class <code><a href='Spectra2D.html'>Spectra2D</a></code>.</p></td>
    </tr>
    <tr>
      <th>parallel</th>
      <td><p>Logical.  Should parallel processing be used?
Unless you love waiting, you should use parallel processing for larger data sets.</p></td>
    </tr>
    <tr>
      <th>setup</th>
      <td><p>Logical.  If <code>TRUE</code> the parallel environment will be automatically
configured for you.  If <code>FALSE</code>, the user must configure the environment
themselves (desirable for instance if working on Azure or AWS EC2).</p></td>
    </tr>
    <tr>
      <th>nfac</th>
      <td><p>Integer.  The number of factors/components to compute.</p></td>
    </tr>
    <tr>
      <th>&#8230;</th>
      <td><p>Additional parameters to be passed to function <code><a href='https://www.rdocumentation.org/packages/multiway/topics/parafac'>parafac</a></code>.
You should give thought to value of <code>const</code>, allowed options can be seen in
<code><a href='https://www.rdocumentation.org/packages/CMLS/topics/const'>const</a></code>. The default is to compute an unconstrained solution.
However, in some cases one may wish to apply a non-negativity constraint.  Also,
to suppress the progress bar, you can use <code>verbose = FALSE</code>.</p></td>
    </tr>
    </table>
    
    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>An object of class <code>pfac</code> and <code>parafac</code>, modified to include a list
element called <code>$method</code> which is <code>parafac</code>.</p>
    
    <h2 class="hasAnchor" id="warning"><a class="anchor" href="#warning"></a>Warning</h2>

    
    <p>To get reproducible results you will need to <code><a href='https://www.rdocumentation.org/packages/base/topics/Random'>set.seed()</a></code>.  See the example.</p>
    
    <h2 class="hasAnchor" id="references"><a class="anchor" href="#references"></a>References</h2>

    <p>R. Bro "PARAFAC. Tutorial and applications" <em>Chemometrics and Intelligent
Laboratory Systems</em> vol. 38 pgs. 149-171 (1997).</p>
<p>A. Smilde, R. Bro and P. Geladi
"Multi-way Analysis: Applications in the Chemical Sciences" Wiley (2004).</p>
    
    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <div class='dont-index'><p>For other data reduction methods for <code>Spectra2D</code> objects, see
<code><a href='miaSpectra2D.html'>miaSpectra2D</a></code> and <code><a href='popSpectra2D.html'>popSpectra2D</a></code>.</p></div>
    

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'>
<span class='fu'><a href='https://www.rdocumentation.org/packages/utils/topics/data'>data</a></span>(<span class='no'>MUD1</span>)
<span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/Random'>set.seed</a></span>(<span class='fl'>123</span>)
<span class='no'>res</span> <span class='kw'>&lt;-</span> <span class='fu'>pfacSpectra2D</span>(<span class='no'>MUD1</span>, <span class='kw'>parallel</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>, <span class='kw'>nfac</span> <span class='kw'>=</span> <span class='fl'>2</span>)</div><div class='output co'>#&gt;   |                                                                              |                                                                      |   0%  |                                                                              |=======                                                               |  10%  |                                                                              |==============                                                        |  20%  |                                                                              |=====================                                                 |  30%  |                                                                              |============================                                          |  40%  |                                                                              |===================================                                   |  50%  |                                                                              |==========================================                            |  60%  |                                                                              |=================================================                     |  70%  |                                                                              |========================================================              |  80%  |                                                                              |===============================================================       |  90%  |                                                                              |======================================================================| 100%</div><div class='input'><span class='fu'><a href='plotScores.html'>plotScores</a></span>(<span class='no'>MUD1</span>, <span class='no'>res</span>, <span class='kw'>leg.loc</span> <span class='kw'>=</span> <span class='st'>"topright"</span>,
  <span class='kw'>ellipse</span> <span class='kw'>=</span> <span class='st'>"cls"</span>, <span class='kw'>main</span> <span class='kw'>=</span> <span class='st'>"PARAFAC Score Plot"</span>)</div><div class='output co'>#&gt; <span class='error'>Error in "pop" %in% class(so): object 'res' not found</span></div><div class='input'><span class='no'>res1</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='plotLoadings2D.html'>plotLoadings2D</a></span>(<span class='no'>MUD1</span>, <span class='no'>res</span>,
  <span class='kw'>load_lvls</span> <span class='kw'>=</span> <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/c'>c</a></span>(<span class='fl'>1</span>, <span class='fl'>5</span>, <span class='fl'>10</span>, <span class='fl'>15</span>, <span class='fl'>25</span>),
  <span class='kw'>main</span> <span class='kw'>=</span> <span class='st'>"PARAFAC Comp. 1 Loadings"</span>)</div><div class='img'><img src='pfacSpectra2D-1.png' alt='' width='700' height='433' /></div><div class='input'><span class='no'>res2</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='plotLoadings2D.html'>plotLoadings2D</a></span>(<span class='no'>MUD1</span>, <span class='no'>res</span>, <span class='kw'>load_lvls</span> <span class='kw'>=</span> <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/c'>c</a></span>(<span class='fl'>1</span>, <span class='fl'>5</span>, <span class='fl'>10</span>, <span class='fl'>15</span>, <span class='fl'>25</span>),
  <span class='kw'>ref</span> <span class='kw'>=</span> <span class='fl'>2</span>, <span class='kw'>ref_lvls</span> <span class='kw'>=</span> <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/seq'>seq</a></span>(<span class='fl'>5</span>, <span class='fl'>35</span>, <span class='fl'>5</span>),
  <span class='kw'>ref_cols</span> <span class='kw'>=</span> <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/rep'>rep</a></span>(<span class='st'>"black"</span>, <span class='fl'>7</span>),
  <span class='kw'>main</span> <span class='kw'>=</span> <span class='st'>"PARAFAC Comp. 1 Loadings + Ref. Spectrum"</span>)</div><div class='img'><img src='pfacSpectra2D-2.png' alt='' width='700' height='433' /></div><div class='input'>
<span class='co'># Selection of loading matrix levels can be aided by the following</span>

<span class='fu'><a href='inspectLvls.html'>inspectLvls</a></span>(<span class='no'>res1</span>, <span class='kw'>loading</span> <span class='kw'>=</span> <span class='fl'>1</span>, <span class='kw'>ylim</span> <span class='kw'>=</span> <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/c'>c</a></span>(<span class='fl'>0</span>, <span class='fl'>50</span>),
  <span class='kw'>main</span> <span class='kw'>=</span> <span class='st'>"Histogram of Loadings Matrix"</span>)</div><div class='img'><img src='pfacSpectra2D-3.png' alt='' width='700' height='433' /></div><div class='input'>
</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
    <h2>Contents</h2>
    <ul class="nav nav-pills nav-stacked">
      <li><a href="#arguments">Arguments</a></li>
      
      <li><a href="#value">Value</a></li>

      <li><a href="#warning">Warning</a></li>

      <li><a href="#references">References</a></li>

      <li><a href="#see-also">See also</a></li>
      
      <li><a href="#examples">Examples</a></li>
    </ul>

    <h2>Author</h2>
    <p>Bryan A. Hanson, DePauw University.</p>
  </div>
</div>

      <footer>
      <div class="copyright">
  <p>Developed by Bryan A. Hanson.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.3.0.</p>
</div>
      </footer>
   </div>

  

  </body>
</html>

