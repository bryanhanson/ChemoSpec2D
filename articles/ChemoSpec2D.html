<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>An Introduction to ChemoSpec2D • ChemoSpec2D</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/united/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="An Introduction to ChemoSpec2D">
<meta property="og:description" content="ChemoSpec2D">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">ChemoSpec2D</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.4.180</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../articles/ChemoSpec2D.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/bryanhanson/ChemoSpec2D/">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="ChemoSpec2D_files/jquery-1.11.3/jquery.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1">
<link href="ChemoSpec2D_files/bootstrap-3.3.5/css/bootstrap.min.css" rel="stylesheet">
<script src="ChemoSpec2D_files/bootstrap-3.3.5/js/bootstrap.min.js"></script><script src="ChemoSpec2D_files/bootstrap-3.3.5/shim/html5shiv.min.js"></script><script src="ChemoSpec2D_files/bootstrap-3.3.5/shim/respond.min.js"></script><style>h1 {font-size: 34px;}
       h1.title {font-size: 38px;}
       h2 {font-size: 30px;}
       h3 {font-size: 24px;}
       h4 {font-size: 18px;}
       h5 {font-size: 16px;}
       h6 {font-size: 12px;}
       code {color: inherit; background-color: rgba(0, 0, 0, 0.04);}
       pre:not([class]) { background-color: white }</style>
<script src="ChemoSpec2D_files/navigation-1.1/tabsets.js"></script><script src="ChemoSpec2D_files/accessible-code-block-0.0.1/empty-anchor.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>An Introduction to ChemoSpec2D</h1>
                        <h4 class="author">Bryan A. Hanson<sup>1</sup>
</h4>
            <address class="author_afil">
      <ol style="list-style-type: decimal">
<li>Professor Emeritus of Chemistry &amp; Biochemistry, DePauw University, Greencastle IN USA.</li>
      </ol>
<br><a class="author_email" href="mailto:#"></a><a href="mailto:hanson@depauw.edu" class="email">hanson@depauw.edu</a>
      </address>
                  
            <h4 class="date">2021-03-02</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/bryanhanson/ChemoSpec2D/blob/master/vignettes/ChemoSpec2D.Rmd"><code>vignettes/ChemoSpec2D.Rmd</code></a></small>
      <div class="hidden name"><code>ChemoSpec2D.Rmd</code></div>

    </div>

    
    
<!-- Run a few things in the background for use later -->
<p>This vignette is based upon <code>ChemoSpec2D</code> version 0.4.180.</p>
<div id="background" class="section level1">
<h1 class="hasAnchor">
<a href="#background" class="anchor"></a><span class="header-section-number">1</span> Background</h1>
<p><code>ChemoSpec2D</code> is designed to analyze 2D spectroscopic data such as COSY and HSQC NMR spectra using appropriate chemometric techniques. It deploys methods aimed primarily at classification of samples and the identification of spectral features which are important in distinguishing samples from each other. <code>ChemoSpec2D</code> stores and manipulates each spectrum as a matrix of data, and hence a data set is a collection of 2D spectra. Thus the entire data set is naturally visualized as a 3D array with dimensions:</p>
<p><span class="math display">\[
\mathrm{F2} \times \mathrm{F1} \times \mathrm{no. \ samples}
\]</span></p>
<p>or</p>
<p><span class="math display">\[
\mathrm{2D \ Spectrum} \times \mathrm{no. \ samples}
\]</span></p>
<p>where F2 and F1 are NMR-speak for the x- and y-axes/dimensions. We will refer to this array as <span class="math inline">\(\underline{\mathbf{X}}\)</span>. See Figure <a href="#fig:array">1.1</a>.</p>
<div class="figure">
<span id="fig:array"></span>
<img src="3Darray.png" alt="Configuration of the data array. $I$, $J$ and $K$ are array indices; F2 and F1 are standard terms for NMR dimensions. The mode terminology is typically used in the PARAFAC literature.  This structure is also sometimes referred to as a data cube." width="60%"><p class="caption">
Figure 1.1: Configuration of the data array. <span class="math inline">\(I\)</span>, <span class="math inline">\(J\)</span> and <span class="math inline">\(K\)</span> are array indices; F2 and F1 are standard terms for NMR dimensions. The mode terminology is typically used in the PARAFAC literature. This structure is also sometimes referred to as a data cube.
</p>
</div>
<p><code>ChemoSpec2D</code> treats each spectrum/matrix as the unit of observation, and thus the physical sample that went into the spectrometer corresponds to the sample from a statistical perspective. Keeping this natural unit intact during analysis is referred to as a <em>strong</em> multi-way analysis. In a weak analysis, the 3D data set is unfolded into a series of contiguous 2D matrices and analyzed using methods suitable for any 2D data set (such methods are fundamentally bilinear) (<span class="citation">Huang et al. (<a href="#ref-Huang2003" role="doc-biblioref">2003</a>)</span>). In the weak approach, each slice of a 2D spectrum becomes just another 1D spectrum, and the relationship between the slices in a single 2D spectrum is lost. Oddly enough, the trilinear/strong analysis has fewer parameters to estimate so it is simpler, but computationally more demanding. The interpretation is also more straight-forward. These techniques are akin to PCA, and seek to <em>reduce the data to a limited number components represented by scores and loadings</em>. As with PCA, noise in the data set is reduced, and correlating variables are collapsed.</p>
<p>The literature on the topics of chemometric analysis of 3D data sets uses a wide variety of terminology to describe analysis options, and the same mathematical analysis can be found under different guises in different fields. Here are some of the terms relevant to <code>ChemoSpec2D</code>:</p>
<ul>
<li>Multivariate Image Analysis (MIA). This term is typically used when the “images” are photographs for example, and the term covers a lot of ground, such as finding particular objects within a photograph. While 2D NMR spectra are typically plotted as contours, there is no reason why they cannot be plotted as an image or heat plot, which is essentially a photographic image. Classification using MIA methods involves a TUCKER1 analysis in which each image is the input, and the sample mode (only) is reduced to a requested number of components. <code>ChemoSpec2D</code> can carry out MIA.</li>
<li>PARAFAC. PARAFAC, or parallel factor analysis, is similar to a method called TUCKER3 in which data reduction occurs on all three dimensions and each dimension can have a different number of factors. With PARAFAC, each dimension is reduced to the <em>same</em> number of components. <code>ChemoSpec2D</code> can carry out PARAFAC and it is discussed in greater detail below.</li>
</ul>
<p>Keirs provides discussion and suggestions on terminology best practices (<span class="citation">Kiers (<a href="#ref-Kiers2000" role="doc-biblioref">2000</a>)</span>).</p>
</div>
<div id="parafac" class="section level1">
<h1 class="hasAnchor">
<a href="#parafac" class="anchor"></a><span class="header-section-number">2</span> PARAFAC</h1>
<div id="theory-light" class="section level2">
<h2 class="hasAnchor">
<a href="#theory-light" class="anchor"></a><span class="header-section-number">2.1</span> Theory (Light)</h2>
<p>PARAFAC is “parallel factor analysis.” This is a statistical technique that is somewhat analogous to PCA. Recall that PCA decomposes a 2D data set into scores and loadings, and is bilinear:</p>
<p><span class="math display">\[
\mathbf{X}^{(n \ \times \ p)} = \mathbf{C}^{(n \ \times \ R)} \times \mathbf{S}^{(R \ \times \ p)} + \mathbf{E}
\]</span></p>
<p>Where <span class="math inline">\(\mathbf{X}\)</span> is the raw data, composed of <span class="math inline">\(n\)</span> samples <span class="math inline">\(\times\)</span> <span class="math inline">\(p\)</span> frequencies, <span class="math inline">\(\mathbf{C}\)</span> are the scores, and <span class="math inline">\(\mathbf{S}\)</span> are the loadings. <span class="math inline">\(R\)</span> is the number of components selected. <span class="math inline">\(R\)</span> is very much smaller than <span class="math inline">\(p\)</span>, as noise and correlating variables have been reduced. Matrix <span class="math inline">\(\mathbf{C}\)</span> can be thought of as “concentrations” or weights. Matrix <span class="math inline">\(\mathbf{S}\)</span> is composed of “spectra” which serve as loadings. <span class="math inline">\(\mathbf{E}\)</span> consists of residuals/error. The goal of the PCA algorithm is to solve this equation and return <span class="math inline">\(\mathbf{C}\)</span> and <span class="math inline">\(\mathbf{S}\)</span>.</p>
<p>In comparison, PARAFAC decomposes a 3D data set into three matrices, and is trilinear. Because the data is 3D, standard matrix algebra cannot be applied. However, the math can be expressed as a summation:</p>
<p><span class="math display">\[
x_{ijk} = \sum_{r = 1}^{R} a_{ir}b_{jr}c_{kr} + \epsilon_{ijk}
\]</span></p>
<p>Where <span class="math inline">\(x_{ijk}\)</span> is an element of the 3D data array <span class="math inline">\(\underline{\mathbf{X}}\)</span>. <span class="math inline">\(a_{ir}\)</span> is an element of the matrix <span class="math inline">\(\mathbf{A}\)</span>, and so forth for <span class="math inline">\(b\)</span>/<span class="math inline">\(\mathbf{B}\)</span> and <span class="math inline">\(c\)</span>/<span class="math inline">\(\mathbf{C}\)</span>. <span class="math inline">\(\epsilon\)</span> is the error term.</p>
<p>If <span class="math inline">\(\underline{\mathbf{X}}\)</span> is flattened by taking the <span class="math inline">\(K\)</span>-dimension slices and concatenating them left-to-right to give a matrix <span class="math inline">\(\mathbf{X}\)</span>, then 2D matrix operations <em>can</em> provide a solution:</p>
<p><span class="math display">\[
\mathbf{X} = \mathbf{A}(\mathbf{C} \odot \mathbf{B})^T + \mathbf{E}
\]</span></p>
<p>Here, <span class="math inline">\(\odot\)</span> represents the Khatri-Rao product, a matrix multiplication variant needed in this situation. <span class="math inline">\(\mathbf{A}\)</span>, <span class="math inline">\(\mathbf{B}\)</span> and <span class="math inline">\(\mathbf{C}\)</span> are the component matrices as above (<span class="citation">Bro and Smilde (<a href="#ref-Bro2003b" role="doc-biblioref">2003</a>)</span>, <span class="citation">Smilde, Bro, and Geladi (<a href="#ref-Smilde2004" role="doc-biblioref">2004</a>)</span> Appendix 4.A presents a number of alternative notations for PARAFAC). If you want to dig into the math, Kolda and Bader is the go-to source (<span class="citation">Kolda and Bader (<a href="#ref-Kolda2009" role="doc-biblioref">2009</a>)</span>).</p>
</div>
<div id="interpretation" class="section level2">
<h2 class="hasAnchor">
<a href="#interpretation" class="anchor"></a><span class="header-section-number">2.2</span> Interpretation</h2>
<p>Regardless of the mathematical representation or algorithmic solution, the results provide <span class="math inline">\(\mathbf{A}\)</span>, <span class="math inline">\(\mathbf{B}\)</span> and <span class="math inline">\(\mathbf{C}\)</span>. Interpretation of the component matrices depends upon how <span class="math inline">\(\underline{\mathbf{X}}\)</span> was constructed (i.e. which dimension represents the samples). In the case of <code>ChemoSpec2D</code> <span class="math inline">\(\mathbf{C}\)</span> contains values analogous to scores in that they can be used to see how samples cluster (this is because the samples are the third dimension of <span class="math inline">\(\underline{\mathbf{X}}\)</span>). Standard matrix multiplication of <span class="math inline">\(\mathbf{A} \ \times \ \mathbf{B^T}\)</span> for a particular column (component) gives a 2D loading plot (a pseudo-spectrum) showing the contributions (loadings) of each peak to the component. <code>ChemoSpec2D</code> uses the <code>R</code> package <code>multiway</code> to carry out PARAFAC (<span class="citation">Helwig (<a href="#ref-Helwig2019" role="doc-biblioref">2019</a>)</span>).</p>
</div>
</div>
<div id="references" class="section level1 unnumbered">
<h1 class="hasAnchor">
<a href="#references" class="anchor"></a>References</h1>
<div id="refs" class="references">
<div id="ref-Bro2003b">
<p>Bro, R, and AK Smilde. 2003. “Centering and Scaling in Component Analysis.” <em>Journal of Chemometrics</em> 17 (1): 16–33. <a href="https://doi.org/10.1002/cem.773">https://doi.org/10.1002/cem.773</a>.</p>
</div>
<div id="ref-Helwig2019">
<p>Helwig, Nathaniel E. 2019. <em>Multiway: Component Models for Multi-Way Data</em>. <a href="https://CRAN.R-project.org/package=multiway">https://CRAN.R-project.org/package=multiway</a>.</p>
</div>
<div id="ref-Huang2003">
<p>Huang, J, H Wium, KB Qvist, and KH Esbensen. 2003. “Multi-Way Methods in Image Analysis-Relationships and Applications.” <em>Chemometrics and Intelligent Laboratory Systems</em> 66 (2): 141–58.</p>
</div>
<div id="ref-Kiers2000">
<p>Kiers, HAL. 2000. “Towards a Standardized Notation and Terminology in Multiway Analysis.” <em>Journal of Chemometrics</em> 14 (3): 105–22.</p>
</div>
<div id="ref-Kolda2009">
<p>Kolda, Tamara G., and Brett W. Bader. 2009. “Tensor Decompositions and Applications.” <em>SIAM Review</em> 51 (3): 455–500. <a href="https://doi.org/10.1137/07070111X">https://doi.org/10.1137/07070111X</a>.</p>
</div>
<div id="ref-Smilde2004">
<p>Smilde, A, R Bro, and P Geladi. 2004. <em>Multi-Way Analysis: Applications in the Chemical Sciences</em>. Wiley.</p>
</div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

      </div>

</div>



      <footer><div class="copyright">
  <p>Developed by Bryan A. Hanson.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
