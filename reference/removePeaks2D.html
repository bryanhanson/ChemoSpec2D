<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Remove Peaks in a Spectra2D Object — removePeaks2D • ChemoSpec2D</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/united/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Remove Peaks in a Spectra2D Object — removePeaks2D"><meta property="og:description" content="This function sets peaks at specified frequencies in a Spectra2D
object to NA. This effectively removes these peaks from calculations of
contours which can speed things up and clarifies the visual presentation of data.
This function is useful for removing regions with large
interfering peaks (e.g. the water peak in 1H NMR), or regions that are primarily
noise.  This function leaves the frequency axes intact.  Note that the
parafac function, used by pfacSpectra2D, does not allow NA
in the input data matrices.  See removeFreq for a way to shrink
the data set without introducing NAs."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">


    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">ChemoSpec2D</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.5.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../articles/ChemoSpec2D.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/bryanhanson/ChemoSpec2D/" class="external-link">
    <span class="fab fa-github fa-lg"></span>

  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->



      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Remove Peaks in a Spectra2D Object</h1>
    <small class="dont-index">Source: <a href="https://github.com/bryanhanson/ChemoSpec2D/blob/main/R/removePeaks2D.R" class="external-link"><code>R/removePeaks2D.R</code></a></small>
    <div class="hidden name"><code>removePeaks2D.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>This function sets peaks at specified frequencies in a <code><a href="Spectra2D.html">Spectra2D</a></code>
object to <code>NA</code>. This effectively removes these peaks from calculations of
contours which can speed things up and clarifies the visual presentation of data.
This function is useful for removing regions with large
interfering peaks (e.g. the water peak in 1H NMR), or regions that are primarily
noise.  This function leaves the frequency axes intact.  Note that the
<code><a href="https://rdrr.io/pkg/multiway/man/parafac.html" class="external-link">parafac</a></code> function, used by <code><a href="pfacSpectra2D.html">pfacSpectra2D</a></code>, does not allow <code>NA</code>
in the input data matrices.  See <code><a href="removeFreq.html">removeFreq</a></code> for a way to shrink
the data set without introducing <code>NA</code>s.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">removePeaks2D</span><span class="op">(</span><span class="va">spectra</span>, remF2 <span class="op">=</span> <span class="cn">NULL</span>, remF1 <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>


<dl><dt id="arg-spectra">spectra<a class="anchor" aria-label="anchor" href="#arg-spectra"></a></dt>
<dd><p>An object of S3 class <code><a href="Spectra2D.html">Spectra2D</a></code> from which to
remove selected peaks.</p></dd>


<dt id="arg-remf-">remF2<a class="anchor" aria-label="anchor" href="#arg-remf-"></a></dt>
<dd><p>A formula giving the range of frequencies to be set to <code>NA</code>.  May include
"low" or "high" representing the extremes of the spectra.    Values outside the range of
F2 are tolerated without notice and are handled <code>min</code> or <code>max</code>.See the examples.</p></dd>


<dt id="arg-remf-">remF1<a class="anchor" aria-label="anchor" href="#arg-remf-"></a></dt>
<dd><p>As for <code>remF2</code>.</p></dd>

</dl></div>
    <div id="value">
    <h2>Value</h2>
    <p>An object of S3 class <code><a href="Spectra2D.html">Spectra2D</a></code>.</p>
    </div>
    <div id="see-also">
    <h2>See also</h2>
    <div class="dont-index"><p><code><a href="https://rdrr.io/pkg/ChemoSpecUtils/man/removeFreq.html" class="external-link">removeFreq</a></code>.</p></div>
    </div>
    <div id="author">
    <h2>Author</h2>
    <p>Bryan A. Hanson, DePauw University.</p>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co"># Note we will set contours a bit low to better</span></span></span>
<span class="r-in"><span><span class="co"># show what is going on.</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">MUD1</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="plotSpectra2D.html">plotSpectra2D</a></span><span class="op">(</span><span class="va">MUD1</span>,</span></span>
<span class="r-in"><span>  which <span class="op">=</span> <span class="fl">7</span>, lvls <span class="op">=</span> <span class="fl">0.1</span>, cols <span class="op">=</span> <span class="st">"black"</span>,</span></span>
<span class="r-in"><span>  main <span class="op">=</span> <span class="st">"MUD1 Sample 7: Complete Data Set"</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="removePeaks2D-1.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">MUD1a</span> <span class="op">&lt;-</span> <span class="fu">removePeaks2D</span><span class="op">(</span><span class="va">MUD1</span>, remF2 <span class="op">=</span> <span class="fl">2.5</span> <span class="op">~</span> <span class="fl">4</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="sumSpectra.html">sumSpectra</a></span><span class="op">(</span><span class="va">MUD1a</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  MUD1: HSQC-like data for testing. See ?MUD1 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 	There are 10 spectra in this set.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 	The F2 dimension runs from 0 to 5 ""^1 * H ~ ppm</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 	and there are 100 data points.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 	The F1 dimension runs from 10 to 80 ""^13 * C ~ ppm</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 	and there are 50 slices.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 	NAs were found in the data matrices.  To see where, use plotSpectra2D.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 	The spectra are divided into 2 groups: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     group no. color</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1 Alcohol   5 black</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2   Ether   5   red</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> *** Note: this is an S3 object</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> of class 'Spectra2D'</span>
<span class="r-in"><span><span class="fu"><a href="plotSpectra2D.html">plotSpectra2D</a></span><span class="op">(</span><span class="va">MUD1a</span>,</span></span>
<span class="r-in"><span>  which <span class="op">=</span> <span class="fl">7</span>, lvls <span class="op">=</span> <span class="fl">0.1</span>, cols <span class="op">=</span> <span class="st">"black"</span>,</span></span>
<span class="r-in"><span>  main <span class="op">=</span> <span class="st">"MUD1 Sample 7\nRemoved Peaks: F2 2.5 ~ 4"</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="removePeaks2D-2.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">MUD1b</span> <span class="op">&lt;-</span> <span class="fu">removePeaks2D</span><span class="op">(</span><span class="va">MUD1</span>, remF2 <span class="op">=</span> <span class="va">low</span> <span class="op">~</span> <span class="fl">2</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="sumSpectra.html">sumSpectra</a></span><span class="op">(</span><span class="va">MUD1b</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  MUD1: HSQC-like data for testing. See ?MUD1 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 	There are 10 spectra in this set.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 	The F2 dimension runs from 0 to 5 ""^1 * H ~ ppm</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 	and there are 100 data points.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 	The F1 dimension runs from 10 to 80 ""^13 * C ~ ppm</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 	and there are 50 slices.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 	NAs were found in the data matrices.  To see where, use plotSpectra2D.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 	The spectra are divided into 2 groups: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     group no. color</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1 Alcohol   5 black</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2   Ether   5   red</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> *** Note: this is an S3 object</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> of class 'Spectra2D'</span>
<span class="r-in"><span><span class="fu"><a href="plotSpectra2D.html">plotSpectra2D</a></span><span class="op">(</span><span class="va">MUD1b</span>,</span></span>
<span class="r-in"><span>  which <span class="op">=</span> <span class="fl">7</span>, lvls <span class="op">=</span> <span class="fl">0.1</span>, cols <span class="op">=</span> <span class="st">"black"</span>,</span></span>
<span class="r-in"><span>  main <span class="op">=</span> <span class="st">"MUD1 Sample 7\nRemoved Peaks: F2 low ~ 2"</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="removePeaks2D-3.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">MUD1c</span> <span class="op">&lt;-</span> <span class="fu">removePeaks2D</span><span class="op">(</span><span class="va">MUD1</span>, remF1 <span class="op">=</span> <span class="va">high</span> <span class="op">~</span> <span class="fl">23</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="sumSpectra.html">sumSpectra</a></span><span class="op">(</span><span class="va">MUD1c</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  MUD1: HSQC-like data for testing. See ?MUD1 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 	There are 10 spectra in this set.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 	The F2 dimension runs from 0 to 5 ""^1 * H ~ ppm</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 	and there are 100 data points.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 	The F1 dimension runs from 10 to 80 ""^13 * C ~ ppm</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 	and there are 50 slices.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 	NAs were found in the data matrices.  To see where, use plotSpectra2D.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 	The spectra are divided into 2 groups: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     group no. color</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1 Alcohol   5 black</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2   Ether   5   red</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> *** Note: this is an S3 object</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> of class 'Spectra2D'</span>
<span class="r-in"><span><span class="fu"><a href="plotSpectra2D.html">plotSpectra2D</a></span><span class="op">(</span><span class="va">MUD1c</span>,</span></span>
<span class="r-in"><span>  which <span class="op">=</span> <span class="fl">7</span>, lvls <span class="op">=</span> <span class="fl">0.1</span>, cols <span class="op">=</span> <span class="st">"black"</span>,</span></span>
<span class="r-in"><span>  main <span class="op">=</span> <span class="st">"MUD1 Sample 7\nRemoved Peaks: F1 high ~ 23"</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="removePeaks2D-4.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">MUD1d</span> <span class="op">&lt;-</span> <span class="fu">removePeaks2D</span><span class="op">(</span><span class="va">MUD1</span>, remF2 <span class="op">=</span> <span class="fl">2.5</span> <span class="op">~</span> <span class="fl">4</span>, remF1 <span class="op">=</span> <span class="fl">45</span> <span class="op">~</span> <span class="fl">55</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="sumSpectra.html">sumSpectra</a></span><span class="op">(</span><span class="va">MUD1d</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  MUD1: HSQC-like data for testing. See ?MUD1 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 	There are 10 spectra in this set.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 	The F2 dimension runs from 0 to 5 ""^1 * H ~ ppm</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 	and there are 100 data points.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 	The F1 dimension runs from 10 to 80 ""^13 * C ~ ppm</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 	and there are 50 slices.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 	NAs were found in the data matrices.  To see where, use plotSpectra2D.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 	The spectra are divided into 2 groups: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     group no. color</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1 Alcohol   5 black</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2   Ether   5   red</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> *** Note: this is an S3 object</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> of class 'Spectra2D'</span>
<span class="r-in"><span><span class="fu"><a href="plotSpectra2D.html">plotSpectra2D</a></span><span class="op">(</span><span class="va">MUD1d</span>,</span></span>
<span class="r-in"><span>  which <span class="op">=</span> <span class="fl">7</span>, lvls <span class="op">=</span> <span class="fl">0.1</span>, cols <span class="op">=</span> <span class="st">"black"</span>,</span></span>
<span class="r-in"><span>  main <span class="op">=</span> <span class="st">"MUD1 Sample 7\nRemoved Peaks: F2 2.5 ~ 4 &amp; F1 45 ~ 55"</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="removePeaks2D-5.png" alt="" width="700" height="433"></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Bryan A. Hanson.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

      </footer></div>






  </body></html>

